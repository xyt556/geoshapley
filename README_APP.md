# GeoShapley 交互式分析工具

这是一个基于 Streamlit 的 GeoShapley 交互式分析工具，提供了友好的图形界面来进行空间机器学习模型的可解释性分析。

## 功能特点

- 📤 **数据上传**: 支持CSV文件上传或使用示例数据
- 🤖 **模型训练**: 支持 AutoML、随机森林、神经网络等多种模型
- 🔍 **GeoShapley分析**: 自动进行空间效应分解和解释
- 📊 **结果可视化**: 多种可视化图表，包括汇总图、部分依赖图、贡献条形图等

## 安装依赖

确保已安装所有必要的库：

```bash
pip install streamlit
pip install -r requirements.txt
pip install "flaml[automl]"
```

## 运行应用

在项目根目录下运行：

```bash
streamlit run app.py
```

应用将在浏览器中自动打开，默认地址为：`http://localhost:8501`

## 使用步骤

### 1. 数据上传
- 上传包含空间坐标的CSV文件，或
- 选择使用示例数据（西雅图房价数据）
- 配置数据：
  - 选择目标变量（y）
  - 选择任务类型（回归/分类）
  - 选择特征列
  - 选择空间坐标列（必须放在最后）

### 2. 模型训练
- 选择模型类型（AutoML/随机森林/神经网络）
- 设置训练参数
- 点击"开始训练"按钮
- 查看模型性能指标

### 3. GeoShapley分析
- 选择背景数据方法（K-means聚类/随机采样）
- 设置背景数据大小
- 设置并行任务数
- 点击"开始分析"按钮
- 查看统计摘要和可加性检查结果

### 4. 结果可视化
- 选择可视化类型：
  - **汇总图**: SHAP风格的汇总图，显示各特征的GeoShapley值分布
  - **部分依赖图**: 显示每个特征的主要效应
  - **贡献条形图**: 全局特征贡献排名
  - **统计摘要表**: 详细的统计信息表格

## 数据格式要求

- CSV文件格式
- 必须包含空间坐标列（如经度、纬度或UTM_X、UTM_Y）
- 空间坐标列必须放在特征列之后（最后几列）

## 示例数据

应用内置了西雅图房价数据作为示例，可以直接使用来测试功能。

## 注意事项

1. **空间坐标位置**: 空间坐标列必须放在DataFrame的最后几列
2. **背景数据大小**: 建议使用100-200个样本作为背景数据
3. **计算时间**: GeoShapley分析可能需要较长时间，取决于数据量和特征数
4. **内存使用**: 大数据集可能需要较多内存

## 技术栈

- **前端框架**: Streamlit
- **机器学习**: scikit-learn, FLAML AutoML
- **空间分析**: GeoShapley
- **可视化**: matplotlib, seaborn, SHAP

## 故障排除

### 问题：无法导入GeoShapley
**解决方案**: 确保已安装geoshapley包：
```bash
pip install -e .
```

### 问题：AutoML训练失败
**解决方案**: 确保已安装flaml的完整版本：
```bash
pip install "flaml[automl]"
```

### 问题：可视化图表不显示
**解决方案**: 确保matplotlib后端正确配置，Streamlit会自动处理

## 许可证

与GeoShapley项目相同的许可证（MIT License）

## 作者

基于GeoShapley库开发的交互式工具

